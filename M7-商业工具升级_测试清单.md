# ScriptFlow 商业工具升级 - 测试验证清单

## 测试环境准备
- [ ] 确保 Node.js 环境正常运行
- [ ] 清理浏览器缓存
- [ ] 打开浏览器开发者工具监控 console 日志

---

## A1 - AI 自动判断题材集数

### 测试步骤
1. 访问 ScriptFlow 系统首页
2. 点击「创建项目」进入 CreateView
3. 输入测试灵感：
   - 测试1: "送外卖的穷小子意外获得万亿遗产，但必须隐瞒身份应对势利眼岳母和绿茶前女友..."
   - 测试2: "被渣男背叛后重生回到大学时代，这次要让渣男付出代价..."
   - 测试3: "意外获得能预知未来5分钟的异能，开始逆袭人生..."
   - 测试4: "修仙废柴意外觉醒上古血脉，一路打脸各种天才..."
4. 点击「立即生成项目」
5. 观察 loading 状态提示
6. 等待项目创建完成,进入 ProjectView

### 验证点
- [ ] CreateView 显示 "AI 正在分析您的灵感..."
- [ ] ProjectView 显示正确的题材标签（如：都市财富 / 复仇重生 / 都市脑洞 / 修仙玄幻）
- [ ] ProjectView 显示推荐的集数（在合理范围内）
- [ ] ProjectView 新增「项目定位」卡片,显示题材、体量、节奏模板
- [ ] Console 无报错,显示 "[createProjectSeed] AI judgment: ..."
- [ ] AI 判断结果合理（题材与灵感匹配）

### 预期结果
- 测试1 → 题材: 都市财富 / 神豪, 集数: 60-120
- 测试2 → 题材: 复仇重生, 集数: 80-150
- 测试3 → 题材: 都市脑洞, 集数: 40-80
- 测试4 → 题材: 穿越/修仙/玄幻, 集数: 80-180

---

## A2 - CreateView 优化

### 测试步骤
1. 打开 CreateView
2. 检查页面元素

### 验证点
- [ ] 删除了题材选择下拉框（如果没有,验证通过）
- [ ] 删除了集数选择器（如果没有,验证通过）
- [ ] 保留了 textarea 输入框
- [ ] 保留了「立即生成项目」按钮
- [ ] 输入框 placeholder 文案清晰
- [ ] 点击生成后,显示 loading 状态

### 预期结果
页面简洁,只保留灵感输入框和生成按钮

---

## A3 - ProjectView 强化

### 测试步骤
1. 创建一个新项目
2. 进入 ProjectView
3. 滚动页面查看所有内容

### 验证点
- [ ] 新增「项目定位」卡片（在 Header 下方）
  - [ ] 显示题材类型
  - [ ] 显示推荐体量
  - [ ] 显示节奏模板
- [ ] 剧情总纲区域增强
  - [ ] 标题显示 "剧情总纲（投稿用）"
  - [ ] 显示字数统计（如：1200 字）
  - [ ] 字数在 800-1500 之间,显示绿色 "✓ 合格"
  - [ ] 「复制投稿版」按钮可用
  - [ ] 点击复制后,显示 "已复制" 提示
- [ ] 一句话卖点正常显示
- [ ] 世界观设定集正常显示
- [ ] 角色池预览正常

### 预期结果
项目定位卡片突出,剧情总纲有字数提示和复制功能

---

## A4 - CharactersView 验证

### 测试步骤
1. 在 ProjectView 点击「查看全部角色」
2. 浏览角色列表和详情

### 验证点
- [ ] 角色按类型分组（主角、反派、配角）
- [ ] 点击角色后,右侧显示详细信息
- [ ] 详细信息包含:
  - [ ] 角色基础信息
  - [ ] 人物背景
  - [ ] 性格与行为模式
  - [ ] 核心动机
  - [ ] 核心弱点
  - [ ] 与主角的关系 & 冲突
  - [ ] 商业功能定位
- [ ] 「复制小传」按钮正常工作
- [ ] 没有"低阶/高阶"标签（如果有,需删除）

### 预期结果
角色信息完整,符合商业级小传要求

---

## B1 - EP1-3 暂停功能

### 测试步骤 1: EpisodesView
1. 创建一个新项目（假设 60 集）
2. 进入 EpisodesView
3. 点击「开始批量生成」
4. 等待生成进度
5. 观察 EP1、EP2、EP3 完成后
6. 观察是否自动暂停

### 验证点 (EpisodesView)
- [ ] EP1、EP2、EP3 生成完成
- [ ] 生成完 EP3 后,batch 状态变为 PAUSED
- [ ] 显示绿色「前 3 集已完成」提示框
- [ ] 提示框说明："您可以继续生成全集，或先人工修改前几集再继续"
- [ ] 「继续生成全集」按钮可用
- [ ] 点击「继续生成全集」后,继续生成 EP4+

### 测试步骤 2: UnifiedWorkspace
1. 进入 UnifiedWorkspace
2. 观察批量生成进度
3. 等 EP1-3 完成后
4. 查看右侧进度区域

### 验证点 (UnifiedWorkspace)
- [ ] Batch 进度显示正确
- [ ] 暂停后,显示绿色「前 3 集已完成」提示
- [ ] 提示说明："可继续生成全集或人工修改"
- [ ] 仍有「继续推进剧情」按钮可用

### 预期结果
EP1-3 完成后自动暂停,UI 显示清晰的暂停提示和继续选项

---

## B2 - App.tsx 流程提示

### 测试步骤
1. 创建一个新项目
2. 观察 loading 状态文案变化

### 验证点
- [ ] Step 1: "AI 正在构思剧本雏形..."
- [ ] Step 2: "AI 正在构建世界观与世界观设定..."
- [ ] Step 3: "AI 正在撰写剧情总纲..."
- [ ] Step 4: "AI 正在编写全集大纲 (X%)... 第 X 集"
- [ ] Step 5: "项目创建完成！推荐体量：X 集。请在生产工作台开始生成剧本。"

### 预期结果
Loading 状态清晰反映当前步骤,最终提示推荐体量

---

## C1 - 导出包优化

### 测试步骤
1. 创建一个新项目（建议测试一个短项目，如 40 集）
2. 生成至少 3 集（EP1-3）
3. 进入 ExportView
4. 选择平台（或使用默认 generic）
5. 点击「导出投稿包」
6. 等待 ZIP 下载
7. 解压 ZIP 包,查看文件结构

### 验证点
- [ ] ZIP 包结构正确:
  ```
  投稿包.zip
  ├── 00_Overview.md
  ├── 01_Story_Overview.md         # 🆕
  ├── 01_Bible.md
  ├── 02_Character_Profiles.md     # 🆕（如果有角色小传）
  ├── 02_Outline.md
  ├── 03_Episodes/
  │   ├── EP01.md
  │   ├── EP02.md
  │   └── EP03.md
  ├── 04_Editor_Report.md
  └── README.md
  ```
- [ ] README.md 内容正确:
  - [ ] 显示 ScriptFlow v3.0
  - [ ] 包结构说明更新,包含 01_Story_Overview.md 和 02_Character_Profiles.md
  - [ ] 使用说明新增: 检查剧情总纲、审阅角色小传
- [ ] 00_Overview.md 包含项目基本信息
- [ ] 01_Story_Overview.md 存在（内容来自 project.synopsis）
- [ ] 01_Bible.md 包含世界观和角色表
- [ ] 02_Outline.md 包含全集大纲
- [ ] 03_Episodes/ 目录包含已生成的剧本
- [ ] 剧本格式符合竖屏短剧标准（场景、时间、地点、人物）
- [ ] 04_Editor_Report.md 包含编辑审稿记录

### 预期结果
导出包包含所有投稿级内容,README 清晰说明使用方法

---

## 综合测试场景

### 场景 1: 完整创作流程
1. 用户输入灵感 → AI 判断题材集数 → 项目创建成功
2. 查看项目定位卡片 → 了解题材和体量
3. 查看剧情总纲 → 复制投稿版（800-1500字）
4. 查看角色小传 → 复制商业级角色设定
5. 开始批量生成 → EP1-3 完成后暂停
6. 查看前 3 集剧本 → 人工修改（如需要）
7. 继续生成全集 → 完成所有剧集
8. 导出投稿包 → 包含所有必需文件
9. 提交给平台审核

**验证**: 整个流程顺畅,用户体验优秀

### 场景 2: AI 判断降级
1. 输入一个模糊的灵感（如"一个关于爱情的故事"）
2. 观察 AI 如何判断

**验证**: 即使判断不够精准,也能给出合理结果（如 romance_ceo）

### 场景 3: 导出不同平台
1. 创建一个项目
2. 测试不同平台的导出（fanqie, hongguo, kuaikan）
3. 对比导出包的差异

**验证**: 平台适配在软差异层面,不改变核心内容

---

## 性能测试

- [ ] AI 判断响应时间 < 10 秒
- [ ] 项目创建完整流程 < 60 秒
- [ ] EP1 生成 < 30 秒（Phase 1 快速生成）
- [ ] EP2-3 生成正常速度
- [ ] 导出 ZIP 包生成时间合理（取决于集数）
- [ ] UI 流畅,无卡顿
- [ ] 轮询正常工作,数据实时更新

---

## 回归测试

- [ ] 老项目仍然可以正常打开
- [ ] 老项目的 EP 生成功能不受影响
- [ ] 老项目的导出功能正常
- [ ] CharactersView 显示老项目的角色信息正常

---

## 已知限制和未来优化

### 当前限制
1. AI 判断可能不够精准（用户手动选项已删除）
   - **未来优化**: 提供人工覆盖选项

2. 暂停只在 EP1-3 生效
   - **未来优化**: 支持自定义暂停点（如每 10 集）

3. 角色小传 Markdown 未实际生成（字段已预留）
   - **未来优化**: 集成 characters_profile prompt 生成完整角色小传

4. 剧情总导（storyOverviewMarkdown）未独立生成（使用 synopsis 字段）
   - **未来优化**: 集成 story_overview prompt 生成投稿级总纲

### 测试通过标准
- 所有核心功能测试通过率 ≥ 90%
- 无阻塞性 bug
- 用户体验明显优于升级前
- 符合 PM 决策的三个核心原则:
  1. 不改动生成核心
  2. 所有改动是"加法在外层"
  3. 人工只关注内容,不关注系统状态

---

## 测试报告模板

**测试日期**: _______________
**测试人员**: _______________
**ScriptFlow 版本**: v3.0

| 功能模块 | 测试结果 | 备注 |
|---------|---------|------|
| A1 - AI 自动判断题材集数 | ☑ 通过 ☐ 失败 |  |
| A2 - CreateView 优化 | ☑ 通过 ☐ 失败 |  |
| A3 - ProjectView 强化 | ☑ 通过 ☐ 失败 |  |
| A4 - CharactersView 验证 | ☑ 通过 ☐ 失败 |  |
| B1 - EP1-3 暂停功能 | ☑ 通过 ☐ 失败 |  |
| B2 - App.tsx 流程提示 | ☑ 通过 ☐ 失败 |  |
| C1 - 导出包优化 | ☑ 通过 ☐ 失败 |  |
| 综合测试场景 | ☑ 通过 ☐ 失败 |  |
| 性能测试 | ☑ 通过 ☐ 失败 |  |
| 回归测试 | ☑ 通过 ☐ 失败 |  |

**总体评价**: ☑ 优秀 ☑ 良好 ☑ 一般 ☐ 需要修复

**建议和问题**: _____________________________

